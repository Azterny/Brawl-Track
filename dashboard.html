<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil - Brawl Track</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="container wide">
        
        <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #333; padding-bottom: 15px; margin-bottom: 20px;">
            <div>
                <h1 id="player-name" style="margin: 0; text-align: left;">Chargement...</h1>
                <span id="player-tag" style="color: #888; font-family: 'Roboto'; font-size: 0.9em;">#...</span>
            </div>
            
            <div id="auth-actions" class="hidden" style="display: flex; gap: 10px;">
                <button onclick="loadMyStats()" style="background-color: #28a745; width: auto; margin:0; font-size: 0.9em;">üîÑ Actualiser</button>
                <button onclick="logout()" style="background-color: #dc3545; width: auto; margin:0; font-size: 0.9em;">D√©co</button>
            </div>

            <div id="public-actions" class="hidden">
                <button onclick="window.location.href='index.html'" style="background-color: #444; width: auto; margin:0;">‚¨Ö Retour</button>
            </div>
        </div>

        <p id="dashboard-msg" style="color: #aaa; font-style: italic;"></p>

        <div id="stats-area" class="stats-grid"></div>

<div id="chart-container" class="hidden" style="margin-top: 30px; background: #222; padding: 15px; border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="color: #ffce00; margin: 0;">üìà Progression</h3>
                <span id="trophy-gain" style="color: #28a745; font-weight: bold;"></span>
            </div>

            <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                <button onclick="updateChartFilter(7)" class="filter-btn">7 Jours</button>
                <button onclick="updateChartFilter(31)" class="filter-btn">Mois</button>
                <button onclick="updateChartFilter(365)" class="filter-btn">Ann√©e</button>
                <button onclick="updateChartFilter(0)" class="filter-btn">Tout</button>
            </div>

            <canvas id="trophyChart"></canvas>
        </div>

        <h3 style="margin-top: 30px; border-top: 1px solid #444; padding-top: 20px;">ü§ñ Brawlers</h3>
        <div id="brawlers-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px;">
            </div>

        <div id="archive-manager" class="hidden" style="margin-top: 40px; border-top: 1px solid #444; padding-top: 20px;">
            <h3>üíæ Gestion des Donn√©es</h3>
            
            <button onclick="manualArchive()" style="background: #17a2b8; margin-bottom: 20px;">‚ûï Ajouter une archive maintenant</button>
            
            <div style="background: #2a2a2a; padding: 15px; border-radius: 8px;">
                <h4 style="margin-top:0;">Nettoyage</h4>
                <select id="delete-select" style="padding: 8px; border-radius: 5px; background: #333; color: white; border: 1px solid #555;">
                    <option value="7">Plus vieilles que 7 Jours</option>
                    <option value="31">Plus vieilles que 31 Jours</option>
                    <option value="365">Plus vieilles que 1 An</option>
                    <option value="custom">Plus vieilles que X Jours...</option>
                    <option value="all">‚ö†Ô∏è TOUT SUPPRIMER</option>
                </select>
                <input type="number" id="custom-days" placeholder="Jours" style="width: 60px; display: none; padding: 8px;">
                
                <button onclick="deleteArchives()" style="background: #dc3545; width: auto; margin-left: 10px;">Supprimer</button>
            </div>
        </div>

        <h3 style="margin-top: 40px; text-align: left; color: #ffce00;">ü§ñ Collection Brawlers</h3>
        <div id="brawlers-grid">
            </div>

    </div>

    <script src="script.js"></script>
    <script>
        // Logique de d√©marrage
        const urlParams = new URLSearchParams(window.location.search);
        const publicTag = urlParams.get('tag');

        if (publicTag) {
            loadPublicProfile(publicTag);
        } else {
            checkAuth();
        }
    </script>
</body>
</html>
